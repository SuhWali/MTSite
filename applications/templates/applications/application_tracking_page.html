{% extends "base.html" %}
{% load wagtailcore_tags %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<style>
    .timeline {
        position: relative;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .timeline::after {
        content: '';
        position: absolute;
        width: 6px;
        background-color: #2196F3;
        top: 0;
        bottom: 0;
        left: 50%;
        margin-left: -3px;
    }

    .timeline-block {
        padding: 10px 40px;
        position: relative;
        width: 50%;
        box-sizing: border-box;
    }

    .timeline-block::after {
        content: '';
        position: absolute;
        width: 25px;
        height: 25px;
        right: -17px;
        background-color: white;
        border: 4px solid #2196F3;
        top: 15px;
        border-radius: 50%;
        z-index: 1;
    }

    .left {
        left: 0;
    }

    .right {
        left: 50%;
    }

    .right::after {
        left: -16px;
    }

    .timeline-content {
        padding: 20px 30px;
        background-color: white;
        position: relative;
        border-radius: 6px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .swiper {
        width: 100%;
        height: 400px;
        margin-bottom: 40px;
    }

    .swiper-slide {
        text-align: center;
        background: #f8f9fa;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .application-form {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }

    .btn-submit {
        background-color: #2196F3;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .btn-submit:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }
    
    .form-field {
        margin-bottom: 1.5rem;
    }
    
    .form-field label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
    }
    
    .form-field input,
    .form-field textarea,
    .form-field select {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid #ddd;
        border-radius: 4px;
    }
    
    .form-field .help-text {
        font-size: 0.875rem;
        color: #6c757d;
        margin-top: 0.25rem;
    }
    
    .form-field .error-message {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }
    
    .form-success {
        background-color: #d4edda;
        color: #155724;
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
    }

    .intro-section {
        text-align: center;
        margin-bottom: 3rem;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    .intro-section h1 {
        color: #2196F3;
        margin-bottom: 1rem;
        font-weight: 700;
    }

    .intro-section p {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #555;
    }

    .benefits-section {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin: 2rem 0 3rem;
    }

    .benefit-card {
        flex-basis: 30%;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        text-align: center;
    }

    .benefit-card h3 {
        color: #2196F3;
        margin-bottom: 0.75rem;
    }

    .benefit-card p {
        color: #666;
    }

    @media (max-width: 768px) {
        .benefit-card {
            flex-basis: 100%;
        }
        
        .timeline-block {
            width: 100%;
            padding-left: 70px;
            padding-right: 25px;
        }
        
        .timeline::after {
            left: 31px;
        }
        
        .right {
            left: 0%;
        }
        
        .left::after, .right::after {
            left: 15px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="intro-section">
        <h1>Join Our Team</h1>
        <p>Thank you for your interest in working with us. We're looking for talented, passionate individuals who share our vision and values. Our application process is designed to be transparent and efficient, keeping you informed every step of the way.</p>
        
        {% if page.intro %}
        <div class="intro mt-4">
            {{ page.intro|richtext }}
        </div>
        {% endif %}
    </div>
    
    <div class="benefits-section">
        <div class="benefit-card">
            <h3>Growth Opportunities</h3>
            <p>We invest in our team members with ongoing training and clear paths for advancement within the organization.</p>
        </div>
        <div class="benefit-card">
            <h3>Collaborative Culture</h3>
            <p>Work alongside talented professionals in a supportive environment that values diverse perspectives.</p>
        </div>
        <div class="benefit-card">
            <h3>Work-Life Balance</h3>
            <p>We offer flexible schedules and competitive benefits to ensure you can thrive both professionally and personally.</p>
        </div>
    </div>
    
    <!-- Carousel Section -->
    {% if page.content %}
    {% include_block page.content with template="blocks/minor_carousel_block.html" %}
    {% endif %}

    <!-- Timeline Section -->
    <div class="timeline">
        <div class="timeline-block left">
            <div class="timeline-content">
                <h2>Application Submitted</h2>
                <p>Your application has been received and is being prepared for review by our hiring team. You'll receive a confirmation email shortly.</p>
            </div>
        </div>
        <div class="timeline-block right">
            <div class="timeline-content">
                <h2>Under Review</h2>
                <p>Our team is carefully evaluating your qualifications, experience, and how well you might fit within our organization. This typically takes 1-2 weeks.</p>
            </div>
        </div>
        <div class="timeline-block left">
            <div class="timeline-content">
                <h2>Interview Scheduled</h2>
                <p>Congratulations! If selected, you'll be invited for an interview. We'll work with you to find a convenient time, whether in-person or virtual.</p>
            </div>
        </div>
        <div class="timeline-block right">
            <div class="timeline-content">
                <h2>Decision Made</h2>
                <p>After the interview process, we'll make our final decision. All candidates will be notified of the outcome, with successful applicants receiving details about next steps.</p>
            </div>
        </div>
    </div>

    <!-- Application Form - Only show if form fields exist -->
    {% with form_fields=page.get_form_fields %}
    {% if form_fields %}
    <div class="application-form" id="applicationForm">
        <h2>Submit Your Application</h2>
        
        {% if form_submission %}
        <div class="form-success">
            {{ page.thank_you_text|richtext }}
        </div>
        {% else %}
            <form action="{% pageurl page %}" method="POST" id="applicationTrackingForm">
                {% csrf_token %}
                
                {% for field in form %}
                <div class="form-field">
                    {{ field.label_tag }}
                    {{ field }}
                    {% if field.help_text %}
                    <div class="help-text">{{ field.help_text }}</div>
                    {% endif %}
                    {% if field.errors %}
                    <div class="error-message">
                        {% for error in field.errors %}
                        {{ error }}
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                
                <button type="submit" class="btn-submit" id="submitBtn">Submit Application</button>
            </form>
        {% endif %}
    </div>
    {% endif %}
    {% endwith %}
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Form deadline handling
        const form = document.getElementById('applicationTrackingForm');
        if (!form) return;
        
        const deadlineInput = document.querySelector('input[name="deadline"]');
        if (!deadlineInput) return;
        
        const submitBtn = document.getElementById('submitBtn');
        if (!submitBtn) return;

        function checkDeadline() {
            if (!deadlineInput.value) return;
            
            const deadline = new Date(deadlineInput.value);
            const now = new Date();
            
            if (now > deadline) {
                submitBtn.disabled = true;
                form.style.opacity = '0.5';
                alert('Application deadline has passed');
            } else {
                submitBtn.disabled = false;
                form.style.opacity = '1';
            }
        }

        checkDeadline();
        deadlineInput.addEventListener('change', checkDeadline);
    });
</script>
{% endblock %}
